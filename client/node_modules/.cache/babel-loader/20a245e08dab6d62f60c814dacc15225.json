{"ast":null,"code":"import shortid from 'shortid';\nimport createStore from './createStore'; // Maybe this should be moved somewhere else\n\nconst words = ['beautiful', 'sparkly', 'grim', 'blue', 'loving', 'crappy', 'distracted', 'javascript', 'OCaml...!'];\nconst ANSWER_VALUE = {\n  CORRECT: '[CORRECT]',\n  WRONG: '[WRONG]'\n};\n\nconst generateText = name => `im a ${words[Math.floor(Math.random() * words.length)]} ${name}`;\n\nexport const componentBuilders = {\n  Text: () => ({\n    name: 'Text',\n    text: generateText('Text'),\n    styleId: 'DefaultText'\n  }),\n  Button: () => ({\n    name: 'Button',\n    text: generateText('Button'),\n    styleId: 'DefaultButton'\n  }),\n  ButtonImage: () => ({\n    name: 'ButtonImage',\n    imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n    fallback: 'This is the default fallback',\n    styleId: 'DefaultButtonImage'\n  }),\n  ButtonGroup: () => ({\n    name: 'ButtonGroup',\n    styleId: 'DefaultButtonGroup',\n    children: []\n  }),\n  SingleAnsChoices: () => ({\n    name: 'SingleAnsChoices',\n    styleId: 'DefaultSingleAnsChoices',\n    withSubmit: true,\n    answers: [{\n      id: shortid.generate(),\n      text: 'Bianco',\n      value: ANSWER_VALUE.CORRECT,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      text: 'Rosso',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      text: 'Blu',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      text: 'Verde',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }]\n  }),\n  MultiAnsChoices: () => ({\n    name: 'MultiAnsChoices',\n    styleId: 'DefaultMultiAnsChoices',\n    withSubmit: true,\n    answers: [{\n      id: shortid.generate(),\n      text: 'Bianco',\n      value: ANSWER_VALUE.CORRECT,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      text: 'Rosso',\n      value: ANSWER_VALUE.CORRECT,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      text: 'Blu',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      text: 'Verde',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }]\n  }),\n  TextArea: () => ({\n    name: 'TextArea',\n    label: 'Default text',\n    rows: 5,\n    styleId: 'DefaultTextArea'\n  }),\n  Input: () => ({\n    name: 'Input',\n    placeholder: 'Default placeholder text',\n    styleId: 'DefaultInput'\n  }),\n  Image: () => ({\n    name: 'Image',\n    imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n    fallback: 'This is the default fallback',\n    styleId: 'DefaultImage'\n  }),\n  AudioPlayer: () => ({\n    name: 'AudioPlayer',\n    srcURL: 'https://assets.mixkit.co/music/preview/mixkit-tech-house-vibes-130.mp3',\n    autoplay: false,\n    styleId: 'DefaultAudioPlayer'\n  }),\n  Background: () => ({\n    name: 'Background',\n    styleId: 'DefaultBackground'\n  }),\n  Spacer: () => ({\n    name: 'Spacer',\n    styleId: 'DefaultSpacer'\n  }),\n  Camera: () => ({\n    name: 'Camera',\n    styleId: 'DefaultCamera'\n  }),\n  SingleAnsChoicesImages: () => ({\n    name: 'SingleAnsChoicesImages',\n    styleId: 'DefaultSingleAnsChoicesImages',\n    withSubmit: true,\n    answers: [{\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.CORRECT,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }]\n  }),\n  MultiAnsChoicesImages: () => ({\n    name: 'MultiAnsChoicesImages',\n    styleId: 'DefaultMultiAnsChoicesImages',\n    withSubmit: true,\n    answers: [{\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.CORRECT,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.CORRECT,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }, {\n      id: shortid.generate(),\n      imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n      alt: 'alt text',\n      value: ANSWER_VALUE.WRONG,\n      points: 0\n    }]\n  }),\n  YoutubePlayer: () => ({\n    name: 'YoutubePlayer',\n    styleId: 'DefaultYoutubePlayer',\n    srcURL: ''\n  }),\n  Points: () => ({\n    name: 'Points',\n    styleId: 'DefaultPoints',\n    messages: [],\n    story: {\n      points: 0\n    }\n  })\n};\n\nconst recursiveFind = (components, targetId) => {\n  for (const component of components) {\n    if (component.id === targetId) return component;\n\n    if (component.children) {\n      const result = recursiveFind(component.children, targetId);\n      if (result) return result;\n    }\n  }\n\n  return undefined;\n};\n\nconst recursiveFilter = (components, targetId) => components.reduce((filtered, component) => {\n  if (component.id === targetId) return filtered;\n\n  if (component.children) {\n    component.children = recursiveFilter(component.children, targetId);\n  }\n\n  filtered.push(component);\n  return filtered;\n}, []);\n\nconst reorder = (list, startIndex, endIndex) => {\n  const result = Array.from(list);\n  const [removed] = result.splice(startIndex, 1);\n  result.splice(endIndex, 0, removed);\n  return result;\n};\n\nconst useTemplateStore = createStore(set => ({\n  components: [{\n    id: shortid.generate(),\n    name: 'Text',\n    text: \"Use the drag handle on the left to reorder components, while you're not editing. After you've saved a style, you can use it on other elements of the same type while in the same session. Once you're done, save the node type with the bottom left button. You'll then be able to use it in the Editor with personalized content!\",\n    styleId: 'DefaultText'\n  }, {\n    id: shortid.generate(),\n    name: 'ButtonGroup',\n    styleId: 'DefaultButtonGroup',\n    children: [{\n      id: shortid.generate(),\n      name: 'Button',\n      text: 'Kiss the toad',\n      styleId: 'DefaultButton'\n    }, {\n      id: shortid.generate(),\n      name: 'Button',\n      text: 'Leave',\n      styleId: 'DefaultButton'\n    }]\n  }],\n  addComponent: (componentName, parentId) => {\n    set(state => {\n      let components = state.components;\n\n      if (parentId) {\n        const parent = recursiveFind(state.components, parentId);\n        components = parent.children;\n      }\n\n      const component = componentBuilders[componentName]();\n      components.push({\n        id: shortid.generate(),\n        ...component\n      });\n    });\n  },\n  changeStyleId: ({\n    componentId,\n    newStyleId\n  }) => {\n    set(state => {\n      const component = recursiveFind(state.components, componentId);\n      component.styleId = newStyleId; // Exception is not allowed so that error is raised (intended behaviour)\n    });\n  },\n  removeComponent: removedId => {\n    set(state => {\n      state.components = recursiveFilter(state.components, removedId);\n    });\n  },\n  reorderComponents: (start, end, dragListId) => {\n    set(state => {\n      if (dragListId) {\n        // Update component sublist\n        const list = recursiveFind(state.components, dragListId);\n        list.children = reorder(list.children, start, end);\n      } else {\n        // Update top level components list\n        state.components = reorder(state.components, start, end);\n      }\n    });\n  }\n}));\nexport default useTemplateStore;","map":{"version":3,"sources":["/home/hmny/Projects/M-and-M/client/src/Creator/stores/template.js"],"names":["shortid","createStore","words","ANSWER_VALUE","CORRECT","WRONG","generateText","name","Math","floor","random","length","componentBuilders","Text","text","styleId","Button","ButtonImage","imgURL","fallback","ButtonGroup","children","SingleAnsChoices","withSubmit","answers","id","generate","value","points","MultiAnsChoices","TextArea","label","rows","Input","placeholder","Image","AudioPlayer","srcURL","autoplay","Background","Spacer","Camera","SingleAnsChoicesImages","alt","MultiAnsChoicesImages","YoutubePlayer","Points","messages","story","recursiveFind","components","targetId","component","result","undefined","recursiveFilter","reduce","filtered","push","reorder","list","startIndex","endIndex","Array","from","removed","splice","useTemplateStore","set","addComponent","componentName","parentId","state","parent","changeStyleId","componentId","newStyleId","removeComponent","removedId","reorderComponents","start","end","dragListId"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,WAAP,MAAwB,eAAxB,C,CAEA;;AACA,MAAMC,KAAK,GAAG,CACZ,WADY,EAEZ,SAFY,EAGZ,MAHY,EAIZ,MAJY,EAKZ,QALY,EAMZ,QANY,EAOZ,YAPY,EAQZ,YARY,EASZ,WATY,CAAd;AAYA,MAAMC,YAAY,GAAG;AACnBC,EAAAA,OAAO,EAAE,WADU;AAEnBC,EAAAA,KAAK,EAAE;AAFY,CAArB;;AAKA,MAAMC,YAAY,GAAGC,IAAI,IACtB,QAAOL,KAAK,CAACM,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBR,KAAK,CAACS,MAAjC,CAAD,CAA2C,IAAGJ,IAAK,EADlE;;AAGA,OAAO,MAAMK,iBAAiB,GAAG;AAC/BC,EAAAA,IAAI,EAAE,OAAO;AACXN,IAAAA,IAAI,EAAE,MADK;AAEXO,IAAAA,IAAI,EAAER,YAAY,CAAC,MAAD,CAFP;AAGXS,IAAAA,OAAO,EAAE;AAHE,GAAP,CADyB;AAM/BC,EAAAA,MAAM,EAAE,OAAO;AACbT,IAAAA,IAAI,EAAE,QADO;AAEbO,IAAAA,IAAI,EAAER,YAAY,CAAC,QAAD,CAFL;AAGbS,IAAAA,OAAO,EAAE;AAHI,GAAP,CANuB;AAW/BE,EAAAA,WAAW,EAAE,OAAO;AAClBV,IAAAA,IAAI,EAAE,aADY;AAElBW,IAAAA,MAAM,EAAE,uEAFU;AAGlBC,IAAAA,QAAQ,EAAE,8BAHQ;AAIlBJ,IAAAA,OAAO,EAAE;AAJS,GAAP,CAXkB;AAiB/BK,EAAAA,WAAW,EAAE,OAAO;AAClBb,IAAAA,IAAI,EAAE,aADY;AAElBQ,IAAAA,OAAO,EAAE,oBAFS;AAGlBM,IAAAA,QAAQ,EAAE;AAHQ,GAAP,CAjBkB;AAsB/BC,EAAAA,gBAAgB,EAAE,OAAO;AACvBf,IAAAA,IAAI,EAAE,kBADiB;AAEvBQ,IAAAA,OAAO,EAAE,yBAFc;AAGvBQ,IAAAA,UAAU,EAAE,IAHW;AAIvBC,IAAAA,OAAO,EAAE,CACP;AACEC,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,QAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACC,OAHtB;AAIEwB,MAAAA,MAAM,EAAE;AAJV,KADO,EAOP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,OAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAHtB;AAIEuB,MAAAA,MAAM,EAAE;AAJV,KAPO,EAaP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,KAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAHtB;AAIEuB,MAAAA,MAAM,EAAE;AAJV,KAbO,EAmBP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,OAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAHtB;AAIEuB,MAAAA,MAAM,EAAE;AAJV,KAnBO;AAJc,GAAP,CAtBa;AAqD/BC,EAAAA,eAAe,EAAE,OAAO;AACtBtB,IAAAA,IAAI,EAAE,iBADgB;AAEtBQ,IAAAA,OAAO,EAAE,wBAFa;AAGtBQ,IAAAA,UAAU,EAAE,IAHU;AAItBC,IAAAA,OAAO,EAAE,CACP;AACEC,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,QAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACC,OAHtB;AAIEwB,MAAAA,MAAM,EAAE;AAJV,KADO,EAOP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,OAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACC,OAHtB;AAIEwB,MAAAA,MAAM,EAAE;AAJV,KAPO,EAaP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,KAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAHtB;AAIEuB,MAAAA,MAAM,EAAE;AAJV,KAbO,EAmBP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEZ,MAAAA,IAAI,EAAE,OAFR;AAGEa,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAHtB;AAIEuB,MAAAA,MAAM,EAAE;AAJV,KAnBO;AAJa,GAAP,CArDc;AAoF/BE,EAAAA,QAAQ,EAAE,OAAO;AACfvB,IAAAA,IAAI,EAAE,UADS;AAEfwB,IAAAA,KAAK,EAAE,cAFQ;AAGfC,IAAAA,IAAI,EAAE,CAHS;AAIfjB,IAAAA,OAAO,EAAE;AAJM,GAAP,CApFqB;AA0F/BkB,EAAAA,KAAK,EAAE,OAAO;AACZ1B,IAAAA,IAAI,EAAE,OADM;AAEZ2B,IAAAA,WAAW,EAAE,0BAFD;AAGZnB,IAAAA,OAAO,EAAE;AAHG,GAAP,CA1FwB;AA+F/BoB,EAAAA,KAAK,EAAE,OAAO;AACZ5B,IAAAA,IAAI,EAAE,OADM;AAEZW,IAAAA,MAAM,EAAE,uEAFI;AAGZC,IAAAA,QAAQ,EAAE,8BAHE;AAIZJ,IAAAA,OAAO,EAAE;AAJG,GAAP,CA/FwB;AAqG/BqB,EAAAA,WAAW,EAAE,OAAO;AAClB7B,IAAAA,IAAI,EAAE,aADY;AAElB8B,IAAAA,MAAM,EAAE,wEAFU;AAGlBC,IAAAA,QAAQ,EAAE,KAHQ;AAIlBvB,IAAAA,OAAO,EAAE;AAJS,GAAP,CArGkB;AA2G/BwB,EAAAA,UAAU,EAAE,OAAO;AACjBhC,IAAAA,IAAI,EAAE,YADW;AAEjBQ,IAAAA,OAAO,EAAE;AAFQ,GAAP,CA3GmB;AA+G/ByB,EAAAA,MAAM,EAAE,OAAO;AACbjC,IAAAA,IAAI,EAAE,QADO;AAEbQ,IAAAA,OAAO,EAAE;AAFI,GAAP,CA/GuB;AAmH/B0B,EAAAA,MAAM,EAAE,OAAO;AACblC,IAAAA,IAAI,EAAE,QADO;AAEbQ,IAAAA,OAAO,EAAE;AAFI,GAAP,CAnHuB;AAuH/B2B,EAAAA,sBAAsB,EAAE,OAAO;AAC7BnC,IAAAA,IAAI,EAAE,wBADuB;AAE7BQ,IAAAA,OAAO,EAAE,+BAFoB;AAG7BQ,IAAAA,UAAU,EAAE,IAHiB;AAI7BC,IAAAA,OAAO,EAAE,CACP;AACEC,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACC,OAJtB;AAKEwB,MAAAA,MAAM,EAAE;AALV,KADO,EAQP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAJtB;AAKEuB,MAAAA,MAAM,EAAE;AALV,KARO,EAeP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAJtB;AAKEuB,MAAAA,MAAM,EAAE;AALV,KAfO,EAsBP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAJtB;AAKEuB,MAAAA,MAAM,EAAE;AALV,KAtBO;AAJoB,GAAP,CAvHO;AA0J/BgB,EAAAA,qBAAqB,EAAE,OAAO;AAC5BrC,IAAAA,IAAI,EAAE,uBADsB;AAE5BQ,IAAAA,OAAO,EAAE,8BAFmB;AAG5BQ,IAAAA,UAAU,EAAE,IAHgB;AAI5BC,IAAAA,OAAO,EAAE,CACP;AACEC,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACC,OAJtB;AAKEwB,MAAAA,MAAM,EAAE;AALV,KADO,EAQP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACC,OAJtB;AAKEwB,MAAAA,MAAM,EAAE;AALV,KARO,EAeP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAJtB;AAKEuB,MAAAA,MAAM,EAAE;AALV,KAfO,EAsBP;AACEH,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEER,MAAAA,MAAM,EAAE,uEAFV;AAGEyB,MAAAA,GAAG,EAAE,UAHP;AAIEhB,MAAAA,KAAK,EAAExB,YAAY,CAACE,KAJtB;AAKEuB,MAAAA,MAAM,EAAE;AALV,KAtBO;AAJmB,GAAP,CA1JQ;AA6L/BiB,EAAAA,aAAa,EAAE,OAAO;AACpBtC,IAAAA,IAAI,EAAE,eADc;AAEpBQ,IAAAA,OAAO,EAAE,sBAFW;AAGpBsB,IAAAA,MAAM,EAAE;AAHY,GAAP,CA7LgB;AAkM/BS,EAAAA,MAAM,EAAE,OAAO;AACbvC,IAAAA,IAAI,EAAE,QADO;AAEbQ,IAAAA,OAAO,EAAE,eAFI;AAGbgC,IAAAA,QAAQ,EAAE,EAHG;AAIbC,IAAAA,KAAK,EAAE;AACLpB,MAAAA,MAAM,EAAE;AADH;AAJM,GAAP;AAlMuB,CAA1B;;AA4MP,MAAMqB,aAAa,GAAG,CAACC,UAAD,EAAaC,QAAb,KAA0B;AAC9C,OAAK,MAAMC,SAAX,IAAwBF,UAAxB,EAAoC;AAClC,QAAIE,SAAS,CAAC3B,EAAV,KAAiB0B,QAArB,EAA+B,OAAOC,SAAP;;AAE/B,QAAIA,SAAS,CAAC/B,QAAd,EAAwB;AACtB,YAAMgC,MAAM,GAAGJ,aAAa,CAACG,SAAS,CAAC/B,QAAX,EAAqB8B,QAArB,CAA5B;AACA,UAAIE,MAAJ,EAAY,OAAOA,MAAP;AACb;AACF;;AAED,SAAOC,SAAP;AACD,CAXD;;AAaA,MAAMC,eAAe,GAAG,CAACL,UAAD,EAAaC,QAAb,KACtBD,UAAU,CAACM,MAAX,CAAkB,CAACC,QAAD,EAAWL,SAAX,KAAyB;AACzC,MAAIA,SAAS,CAAC3B,EAAV,KAAiB0B,QAArB,EAA+B,OAAOM,QAAP;;AAE/B,MAAIL,SAAS,CAAC/B,QAAd,EAAwB;AACtB+B,IAAAA,SAAS,CAAC/B,QAAV,GAAqBkC,eAAe,CAACH,SAAS,CAAC/B,QAAX,EAAqB8B,QAArB,CAApC;AACD;;AAEDM,EAAAA,QAAQ,CAACC,IAAT,CAAcN,SAAd;AACA,SAAOK,QAAP;AACD,CATD,EASG,EATH,CADF;;AAYA,MAAME,OAAO,GAAG,CAACC,IAAD,EAAOC,UAAP,EAAmBC,QAAnB,KAAgC;AAC9C,QAAMT,MAAM,GAAGU,KAAK,CAACC,IAAN,CAAWJ,IAAX,CAAf;AACA,QAAM,CAACK,OAAD,IAAYZ,MAAM,CAACa,MAAP,CAAcL,UAAd,EAA0B,CAA1B,CAAlB;AACAR,EAAAA,MAAM,CAACa,MAAP,CAAcJ,QAAd,EAAwB,CAAxB,EAA2BG,OAA3B;AACA,SAAOZ,MAAP;AACD,CALD;;AAOA,MAAMc,gBAAgB,GAAGlE,WAAW,CAACmE,GAAG,KAAK;AAC3ClB,EAAAA,UAAU,EAAE,CACV;AACEzB,IAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEnB,IAAAA,IAAI,EAAE,MAFR;AAGEO,IAAAA,IAAI,EACF,oUAJJ;AAKEC,IAAAA,OAAO,EAAE;AALX,GADU,EAQV;AACEU,IAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEnB,IAAAA,IAAI,EAAE,aAFR;AAGEQ,IAAAA,OAAO,EAAE,oBAHX;AAIEM,IAAAA,QAAQ,EAAE,CACR;AACEI,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEnB,MAAAA,IAAI,EAAE,QAFR;AAGEO,MAAAA,IAAI,EAAE,eAHR;AAIEC,MAAAA,OAAO,EAAE;AAJX,KADQ,EAOR;AACEU,MAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADN;AAEEnB,MAAAA,IAAI,EAAE,QAFR;AAGEO,MAAAA,IAAI,EAAE,OAHR;AAIEC,MAAAA,OAAO,EAAE;AAJX,KAPQ;AAJZ,GARU,CAD+B;AA6B3CsD,EAAAA,YAAY,EAAE,CAACC,aAAD,EAAgBC,QAAhB,KAA6B;AACzCH,IAAAA,GAAG,CAACI,KAAK,IAAI;AACX,UAAItB,UAAU,GAAGsB,KAAK,CAACtB,UAAvB;;AACA,UAAIqB,QAAJ,EAAc;AACZ,cAAME,MAAM,GAAGxB,aAAa,CAACuB,KAAK,CAACtB,UAAP,EAAmBqB,QAAnB,CAA5B;AACArB,QAAAA,UAAU,GAAGuB,MAAM,CAACpD,QAApB;AACD;;AAED,YAAM+B,SAAS,GAAGxC,iBAAiB,CAAC0D,aAAD,CAAjB,EAAlB;AACApB,MAAAA,UAAU,CAACQ,IAAX,CAAgB;AACdjC,QAAAA,EAAE,EAAEzB,OAAO,CAAC0B,QAAR,EADU;AAEd,WAAG0B;AAFW,OAAhB;AAID,KAZE,CAAH;AAaD,GA3C0C;AA4C3CsB,EAAAA,aAAa,EAAE,CAAC;AAAEC,IAAAA,WAAF;AAAeC,IAAAA;AAAf,GAAD,KAAiC;AAC9CR,IAAAA,GAAG,CAACI,KAAK,IAAI;AACX,YAAMpB,SAAS,GAAGH,aAAa,CAACuB,KAAK,CAACtB,UAAP,EAAmByB,WAAnB,CAA/B;AACAvB,MAAAA,SAAS,CAACrC,OAAV,GAAoB6D,UAApB,CAFW,CAGX;AACD,KAJE,CAAH;AAKD,GAlD0C;AAmD3CC,EAAAA,eAAe,EAAEC,SAAS,IAAI;AAC5BV,IAAAA,GAAG,CAACI,KAAK,IAAI;AACXA,MAAAA,KAAK,CAACtB,UAAN,GAAmBK,eAAe,CAACiB,KAAK,CAACtB,UAAP,EAAmB4B,SAAnB,CAAlC;AACD,KAFE,CAAH;AAGD,GAvD0C;AAwD3CC,EAAAA,iBAAiB,EAAE,CAACC,KAAD,EAAQC,GAAR,EAAaC,UAAb,KAA4B;AAC7Cd,IAAAA,GAAG,CAACI,KAAK,IAAI;AACX,UAAIU,UAAJ,EAAgB;AACd;AACA,cAAMtB,IAAI,GAAGX,aAAa,CAACuB,KAAK,CAACtB,UAAP,EAAmBgC,UAAnB,CAA1B;AACAtB,QAAAA,IAAI,CAACvC,QAAL,GAAgBsC,OAAO,CAACC,IAAI,CAACvC,QAAN,EAAgB2D,KAAhB,EAAuBC,GAAvB,CAAvB;AACD,OAJD,MAIO;AACL;AACAT,QAAAA,KAAK,CAACtB,UAAN,GAAmBS,OAAO,CAACa,KAAK,CAACtB,UAAP,EAAmB8B,KAAnB,EAA0BC,GAA1B,CAA1B;AACD;AACF,KATE,CAAH;AAUD;AAnE0C,CAAL,CAAJ,CAApC;AAsEA,eAAed,gBAAf","sourcesContent":["import shortid from 'shortid';\nimport createStore from './createStore';\n\n// Maybe this should be moved somewhere else\nconst words = [\n  'beautiful',\n  'sparkly',\n  'grim',\n  'blue',\n  'loving',\n  'crappy',\n  'distracted',\n  'javascript',\n  'OCaml...!',\n];\n\nconst ANSWER_VALUE = {\n  CORRECT: '[CORRECT]',\n  WRONG: '[WRONG]',\n};\n\nconst generateText = name =>\n  `im a ${words[Math.floor(Math.random() * words.length)]} ${name}`;\n\nexport const componentBuilders = {\n  Text: () => ({\n    name: 'Text',\n    text: generateText('Text'),\n    styleId: 'DefaultText',\n  }),\n  Button: () => ({\n    name: 'Button',\n    text: generateText('Button'),\n    styleId: 'DefaultButton',\n  }),\n  ButtonImage: () => ({\n    name: 'ButtonImage',\n    imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n    fallback: 'This is the default fallback',\n    styleId: 'DefaultButtonImage',\n  }),\n  ButtonGroup: () => ({\n    name: 'ButtonGroup',\n    styleId: 'DefaultButtonGroup',\n    children: [],\n  }),\n  SingleAnsChoices: () => ({\n    name: 'SingleAnsChoices',\n    styleId: 'DefaultSingleAnsChoices',\n    withSubmit: true,\n    answers: [\n      {\n        id: shortid.generate(),\n        text: 'Bianco',\n        value: ANSWER_VALUE.CORRECT,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        text: 'Rosso',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        text: 'Blu',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        text: 'Verde',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n    ],\n  }),\n  MultiAnsChoices: () => ({\n    name: 'MultiAnsChoices',\n    styleId: 'DefaultMultiAnsChoices',\n    withSubmit: true,\n    answers: [\n      {\n        id: shortid.generate(),\n        text: 'Bianco',\n        value: ANSWER_VALUE.CORRECT,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        text: 'Rosso',\n        value: ANSWER_VALUE.CORRECT,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        text: 'Blu',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        text: 'Verde',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n    ],\n  }),\n  TextArea: () => ({\n    name: 'TextArea',\n    label: 'Default text',\n    rows: 5,\n    styleId: 'DefaultTextArea',\n  }),\n  Input: () => ({\n    name: 'Input',\n    placeholder: 'Default placeholder text',\n    styleId: 'DefaultInput',\n  }),\n  Image: () => ({\n    name: 'Image',\n    imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n    fallback: 'This is the default fallback',\n    styleId: 'DefaultImage',\n  }),\n  AudioPlayer: () => ({\n    name: 'AudioPlayer',\n    srcURL: 'https://assets.mixkit.co/music/preview/mixkit-tech-house-vibes-130.mp3',\n    autoplay: false,\n    styleId: 'DefaultAudioPlayer',\n  }),\n  Background: () => ({\n    name: 'Background',\n    styleId: 'DefaultBackground',\n  }),\n  Spacer: () => ({\n    name: 'Spacer',\n    styleId: 'DefaultSpacer',\n  }),\n  Camera: () => ({\n    name: 'Camera',\n    styleId: 'DefaultCamera',\n  }),\n  SingleAnsChoicesImages: () => ({\n    name: 'SingleAnsChoicesImages',\n    styleId: 'DefaultSingleAnsChoicesImages',\n    withSubmit: true,\n    answers: [\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.CORRECT,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n    ],\n  }),\n  MultiAnsChoicesImages: () => ({\n    name: 'MultiAnsChoicesImages',\n    styleId: 'DefaultMultiAnsChoicesImages',\n    withSubmit: true,\n    answers: [\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.CORRECT,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.CORRECT,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n      {\n        id: shortid.generate(),\n        imgURL: 'https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png',\n        alt: 'alt text',\n        value: ANSWER_VALUE.WRONG,\n        points: 0,\n      },\n    ],\n  }),\n  YoutubePlayer: () => ({\n    name: 'YoutubePlayer',\n    styleId: 'DefaultYoutubePlayer',\n    srcURL: '',\n  }),\n  Points: () => ({\n    name: 'Points',\n    styleId: 'DefaultPoints',\n    messages: [],\n    story: {\n      points: 0,\n    },\n  }),\n};\n\nconst recursiveFind = (components, targetId) => {\n  for (const component of components) {\n    if (component.id === targetId) return component;\n\n    if (component.children) {\n      const result = recursiveFind(component.children, targetId);\n      if (result) return result;\n    }\n  }\n\n  return undefined;\n};\n\nconst recursiveFilter = (components, targetId) =>\n  components.reduce((filtered, component) => {\n    if (component.id === targetId) return filtered;\n\n    if (component.children) {\n      component.children = recursiveFilter(component.children, targetId);\n    }\n\n    filtered.push(component);\n    return filtered;\n  }, []);\n\nconst reorder = (list, startIndex, endIndex) => {\n  const result = Array.from(list);\n  const [removed] = result.splice(startIndex, 1);\n  result.splice(endIndex, 0, removed);\n  return result;\n};\n\nconst useTemplateStore = createStore(set => ({\n  components: [\n    {\n      id: shortid.generate(),\n      name: 'Text',\n      text:\n        \"Use the drag handle on the left to reorder components, while you're not editing. After you've saved a style, you can use it on other elements of the same type while in the same session. Once you're done, save the node type with the bottom left button. You'll then be able to use it in the Editor with personalized content!\",\n      styleId: 'DefaultText',\n    },\n    {\n      id: shortid.generate(),\n      name: 'ButtonGroup',\n      styleId: 'DefaultButtonGroup',\n      children: [\n        {\n          id: shortid.generate(),\n          name: 'Button',\n          text: 'Kiss the toad',\n          styleId: 'DefaultButton',\n        },\n        {\n          id: shortid.generate(),\n          name: 'Button',\n          text: 'Leave',\n          styleId: 'DefaultButton',\n        },\n      ],\n    },\n  ],\n  addComponent: (componentName, parentId) => {\n    set(state => {\n      let components = state.components;\n      if (parentId) {\n        const parent = recursiveFind(state.components, parentId);\n        components = parent.children;\n      }\n\n      const component = componentBuilders[componentName]();\n      components.push({\n        id: shortid.generate(),\n        ...component,\n      });\n    });\n  },\n  changeStyleId: ({ componentId, newStyleId }) => {\n    set(state => {\n      const component = recursiveFind(state.components, componentId);\n      component.styleId = newStyleId;\n      // Exception is not allowed so that error is raised (intended behaviour)\n    });\n  },\n  removeComponent: removedId => {\n    set(state => {\n      state.components = recursiveFilter(state.components, removedId);\n    });\n  },\n  reorderComponents: (start, end, dragListId) => {\n    set(state => {\n      if (dragListId) {\n        // Update component sublist\n        const list = recursiveFind(state.components, dragListId);\n        list.children = reorder(list.children, start, end);\n      } else {\n        // Update top level components list\n        state.components = reorder(state.components, start, end);\n      }\n    });\n  },\n}));\n\nexport default useTemplateStore;\n"]},"metadata":{},"sourceType":"module"}